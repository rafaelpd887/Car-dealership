---
title: "Análises Estatísticas"
author: "Rafael"
date: "2023-07-16"
output: html_document
---
# Carregando pacotes e datasets, e eliminando as colunas referentes ao "id"
```{r package, message=FALSE, results='hide'}
pacotes <- c("readxl", "PerformanceAnalytics")
lapply(pacotes, library, character.only = TRUE)
```

```{r load}
cars_train <- read_excel("cars_train.xlsx")
cars_test <- read_excel("cars_test.xlsx")
```

```{r remove}
cars_train <- cars_train[-1]
cars_test <- cars_test[-1]
```

# Calculando e exibindo a matriz de correlação
```{r correlation, warning=FALSE}
chart.Correlation((cars_train[, c(1, 5:7, 9, 28)]), histogram = TRUE)
```

A matriz de correlação nos permite compreender a relação que as variáveis numéricas mantém entre si. Podemos ver que "num_fotos" e "num_portas" possuem baixa correlação com todas as outras e que pouco influenciam no preço dos automóveis. 

Curiosamente, "num_portas" apresenta uma leve correlação negativa com o preço, o que pode parecer contra-intuitivo devido ao senso comum de que carros com mais portas tendem a serem mais caros por serem maiores e etc. Entretanto, os dados apresentam essse comportamento devido a presença de observações que representam carros esportivos de luxo de duas portas que possuem um valor muito elevado. 

As outras variáveis numéricas seguem um comportamento esperado. "ano_de_fabricacao" apresenta forte correlação positiva com "ano_modelo", e ambas apresentam correlação positiva com preço. Indicando que quanto mais novo o carro, maior tende a ser o seu preço.

A variável "hodometro" também segue um comportamento esperado, apresentando correlação negativa com "ano_de_fabricacao", "ano_modelo" e "preco". Podemos inferir que carros mais antigos tendem a ter uma quilometragem registrada no hodômetro maior. Consequentemente, quanto maior a quilometragem registrada no hodômetro, menor é o preço do automóvel.

Essa breve análise nos mostra que as variáveis numéricas, no geral, possuem relações confiáveis e coerentes com a realidade.

# Análise de Variância 
```{r anova}
cars_train <- replace(cars_train, is.na(cars_train), "nao")
anova <- aov(preco ~ marca, data = cars_train) 
summary(anova)                                      
```

<span style="font-size: smaller;"> _Caso desejemos analisar uma variável diferente de "marca", basta substituir "marca" pelo nome da variável desejada. Antes de usar a função `aov` foi necessário um pequeno tratamento nos dados para eliminar os valores vazios (NA)._

As análises de variância (ANOVA) são úteis para avaliar o grau de significância de uma variável em relação a outra, permitindo uma compreensão clara das relações entre as variáveis. Quando usadas em conjunto com análises de correlação, obtemos um panorama abrangente das relações entre as variáveis.

Usando a função `aov`, foi possível analisar todas as variáveis independentes em função da variável dependente "preco".

Os resultados indicaram que praticamente todas as variáveis se mostraram significantes para a formação do preço a um nível de confiança de 95%. As únicas variáveis que não se mostraram significantes a 95% de confiança foram "elegivel_revisao", "ipva_pago" e "veiculo_alienado".

# Exibindo estatísticas das variáveis
```{r summary}
summary(cars_train)
summary(cars_test)
```

Através da função `summary`, podemos visualizar informações estatísticas sobre as variáveis nos conjuntos de dados "cars_train" e "cars_test". Ela fornece o tipo de cada variável, além da amplitude e de informações estatísticas, como a média, mediana e quartis para as variáveis numéricas.

Após analisar o conjunto de dados usando a função `summary`, podemos observar algumas informações relevantes. Por exemplo, a média dos preços dos carros é de 133.024. Além disso, notamos que o conjunto de dados possui observações que representam carros muito recentes, com ano do modelo igual a 2023, assim como observações relacionadas a carros mais antigos, com o ano de fabricação em 1985. 

Observamos também uma variação considerável na quilometragem registrada nos hodômetros dos carros no conjunto de dados. Alguns carros possuem uma quilometragem muito baixa, sugerindo um uso limitado, enquanto outros apresentam uma quilometragem bastante elevada, indicando um uso mais extensivo.

Assim, o uso da `summary` nos permite ter uma visão geral das características e distribuição das variáveis. Essas informações estatísticas são úteis para entender melhor os dados e identificar possíveis discrepâncias, outliers ou padrões nos valores das variáveis.

# Exibindo as categorias/níveis das variáveis qualitativas
```{r levels}
levels(factor(cars_train$marca)) 
levels(factor(cars_test$marca))  
```

<span style="font-size: smaller;"> _Caso desejemos analisar uma variável diferente de "marca", basta substituir "marca" pelo nome da variável desejada._

A função `levels` nos permite identificar a quantidade de categorias/níveis presentes nas variáveis qualitativas/categóricas. Essa função é útil, pois em conjunto com outras análises, nos proporciona uma boa compreensão da complexidade dos dados com os quais estamos lidando.

Nesse caso em especial, observamos que algumas das variáveis qualitativas possuem uma grande quantidade de categorias, com destaque para a variável "versao".

Isso indica que o treinamento de um modelo preditivo será desafiador, uma vez que essas variáveis aumentam a complexidade do modelo e devem ser incluídas no treinamento, pois sabemos, tanto por meio das análises realizadas aqui como por nossa experiência no mundo real, que variáveis como modelo, versão e marca do carro têm influência direta no preço.

Percebe-se também que as categorias das variáveis qualitativas não são exatamente as mesmas nos dois datasets. Por exemplo, a categoria "BRM" da variável "marca" é exclusiva do dataset "cars_train". Logo, será necessário um tratamento especial nos dados para que seja possível fazer previsões de preço no dataset "cars_test" usando um modelo treinado a partir do datase "cars_train".

# Exibindo as frequências de cada categoria/nível das variáveis qualitativas
```{r table}
table(cars_train$marca)         
table(cars_test$marca)          
```

<span style="font-size: smaller;"> _Caso desejemos analisar uma variável diferente de "marca", basta substituir "marca" pelo nome da variável desejada._

A função `table` também é muito útil para obter informações sobre as variáveis qualitativas. Ela nos permite verificar a contagem de observações em cada uma das categorias de uma variável qualitativa..

Ao analisarmos os dados, observamos que variáveis com um maior número de categorias apresentam algumas categorias com um número muito pequeno de observações. Especificamente, a variável "versao" possui várias categorias com poucas observações.

Conforme mencionado anteriormente, essa característica em um conjunto de dados pode tornar as previsões mais desafiadoras, especialmente quando não podemos simplesmente excluir as variáveis que possuem essas características.
